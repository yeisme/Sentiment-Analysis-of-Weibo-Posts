# Sentiment Analysis of Weibo Posts During the Pandemic - 疫情微博情绪分类

## 任务描述

输出是该微博所蕴含的情绪类别。微博情绪分类任务旨在识别微博中蕴含的情绪，输入是一条微博，在本次任务中，我们将微博按照其蕴含的情绪分为以下六个类别之一: 积极、愤怒、悲伤、恐惧、惊奇和无情绪 (0,1,2,3,4,5)。

> 数据集
> 疫情微博训练数据集包括 6,606 条微博，测试数据集包含 5.000 条微博
> 训练数据集: virus_train.csv
> 测试数据集: virus_test.csv

评价指标:

- **宏精确度 (Macro Precision)**
  $$Macro\_P = \frac{1}{C} \sum_{i=1}^{C} P_i = \frac{1}{C} \sum_{i=1}^{C} \frac{TP_i}{TP_i + FP_i}$$

- **宏召回率 (Macro Recall)**
  $$Macro\_R = \frac{1}{C} \sum_{i=1}^{C} R_i = \frac{1}{C} \sum_{i=1}^{C} \frac{TP_i}{TP_i + FN_i}$$

- **宏 F1 值 (Macro F1-Score)**
  $$Macro\_F1 = \frac{2 \times Macro\_P \times Macro\_R}{Macro\_P + Macro\_R}$$

**公式符号详细说明：**

- $C$ ：类别总数（本任务中为 6 个情绪类别）
- $i$ ：类别索引，取值范围为 1 到 C（即 1 到 6）
- $P_i$ ：第$i$类的精确度（Precision）
- $R_i$ ：第$i$类的召回率（Recall）
- $TP_i$ ：第$i$类的真正例（True Positive）- 正确预测为第$i$类的样本数
- $FP_i$ ：第$i$类的假正例（False Positive）- 错误预测为第$i$类的样本数
- $FN_i$ ：第$i$类的假负例（False Negative）- 实际为第$i$类但预测为其他类的样本数
- $\sum_{i=1}^{C}$ ：对所有类别求和的符号

**举例说明：**
对于"积极"情绪类别（假设为第 1 类）：

- $TP_1$：模型正确识别为"积极"的微博数量
- $FP_1$：模型错误识别为"积极"的微博数量（实际为其他情绪）
- $FN_1$：实际为"积极"但被模型识别为其他情绪的微博数量

宏平均的计算方式是先计算每个类别的指标，然后求平均值，这样可以平等对待每个类别，不受类别样本数量不平衡的影响。

要求同学们以提高在测试集上的效果为目标，自己根据数据特点及需要进行数据预处理以及模型设计。
本任务不对模型的选择和设计进行限制，同时要求训练所用数据不脱离给定的数据集范围不可引入外部语料(例如通过外部语料得到的预训练词向量等)，可以以 CNN、RNN 等模型为基础进行设计
实验报告中需要包含但不限于数据的处理过程介绍(例如分词等)、词向量、模型图、模型中各部分的作用介绍或者使用理由、超参数设置以及训练过程中各指标变化和实验结果分析等。

提示:可使用 python 中的 **gensim** 库在给定语料上进行词向量训练注:为保证公平，在训练过程中同样也不可引入测试数据，测试数据只用于最终评估

## 任务流程

### 数据预处理 (Data Preprocessing)

- 🧹 **文本清洗**
  - 去除 URL、@用户名、特殊符号
  - 处理表情符号和 emoji
  - 统一繁简体转换
- ✂️ **中文分词**
  - 使用 gensim 等工具进行中文分词
  - 去除停用词
  - 保留情绪相关的关键词
- 🔤 **文本标准化**
  - 处理重复字符（如"好好好"→"好"）
  - 统一数字和英文的处理方式
  - 处理长度过短或过长的文本

### 词向量训练 (Word Embedding)

- 📚 **语料准备**
  - 基于训练集构建词汇表
  - 设置最小词频阈值
- 🎯 **Word2Vec 训练**
  - 使用 gensim 库训练 Word2Vec 模型
  - 调优向量维度、窗口大小等超参数
  - 验证词向量质量（相似词检验）

### 模型设计 (Model Architecture)

- 🏗️ **基础模型选择**
  - CNN 模型：捕获局部 n-gram 特征
  - RNN/LSTM/GRU：处理序列依赖关系
  - 混合模型：结合 CNN 和 RNN 优势
- ⚙️ **网络结构设计**
  - 嵌入层：加载预训练词向量
  - 特征提取层：CNN 卷积或 RNN 循环
  - 分类层：全连接层 + Softmax
- 🎛️ **超参数设置**
  - 学习率、批次大小、dropout 率
  - 隐藏层维度、卷积核大小
  - 优化器选择（Adam、SGD 等）

### 模型训练 (Model Training)

- 🔄 **训练策略**
  - 数据划分：训练集/验证集分割
  - 批次训练和梯度更新
  - 早停机制防止过拟合
- 📈 **训练监控**
  - 记录训练损失和准确率曲线
  - 监控验证集性能变化
  - 保存最佳模型检查点
- ⚖️ **类别平衡处理**
  - 类别权重调整
  - 数据增强技术
  - 采样策略优化

### 5. 模型评估 (Model Evaluation)

- 🎯 **性能评估**
  - 在验证集上计算宏精确度、宏召回率、宏 F1 值
  - 绘制混淆矩阵分析各类别预测效果
  - 错误样本分析和 case study
- 🔧 **模型优化**
  - 超参数调优（网格搜索、贝叶斯优化）
  - 模型集成（投票、平均等）
  - 特征工程改进

### 最终测试 (Final Testing)

- 🏆 **测试集评估**
  - 使用最佳模型在测试集上预测
  - 计算最终的宏精确度、宏召回率、宏 F1 值
  - 生成预测结果文件
- 📊 **结果分析**
  - 各情绪类别的详细性能分析
  - 模型预测的置信度分析
  - 失败案例的深入分析

### 报告撰写 (Report Writing)

- 📝 **实验报告内容**
  - 数据预处理详细过程
  - 词向量训练方法和参数
  - 模型架构图和设计思路
  - 超参数选择和调优过程
  - 训练过程中各指标变化趋势
  - 最终结果分析和改进建议
